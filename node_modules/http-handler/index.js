if (request == null) var request = require('request');

var retrieveAffiliationsJSON = function (successCb, failureCb, args) {
  var query = args['query'];

      // Set the headers
    var headers = {
        'Content-type' : 'application/x-www-form-urlencoded',
        'Authorization': 'Basic ' + new Buffer("cmput402:qpskcnvb").toString('base64')
    }

    // Configure the request
    var options = {
        url: "http://199.116.235.47/centralrepo/v1/pull_affiliations",
        headers: headers,
        form: query
    }
    console.log(query)
    // Start the request
    request.post(options, function (error, response, body) {
         // Print out the response body
         successCb(JSON.parse(body));
    })
}

exports.retrieveAffiliationsJSON = retrieveAffiliationsJSON;